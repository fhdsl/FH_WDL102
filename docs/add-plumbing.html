<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Add plumbing | WDL102: Designing Workflows</title>
  <meta name="description" content="A getting started guide to creating and testing WDL workflows" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Add plumbing | WDL102: Designing Workflows" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A getting started guide to creating and testing WDL workflows" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Add plumbing | WDL102: Designing Workflows" />
  
  <meta name="twitter:description" content="A getting started guide to creating and testing WDL workflows" />
  



<meta name="date" content="2022-10-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />
<link rel="prev" href="add-variables.html"/>
<link rel="next" href="linear-chaining-1.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="https://hutchdatascience.org/" target="_blank"><img src="assets/big-dasl-stacked.png" style="width: 80%; padding-left: 15px; padding-top: 8px;"</a>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this Book</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-wdl.html"><a href="introduction-to-wdl.html"><i class="fa fa-check"></i><b>2</b> Introduction to WDL</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-wdl.html"><a href="introduction-to-wdl.html#openwdl"><i class="fa fa-check"></i><b>2.1</b> openWDL</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-wdl.html"><a href="introduction-to-wdl.html#wdl-1.0-syntax"><i class="fa fa-check"></i><b>2.2</b> WDL 1.0 Syntax</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="base-structure.html"><a href="base-structure.html"><i class="fa fa-check"></i><b>3</b> Base structure</a>
<ul>
<li class="chapter" data-level="3.1" data-path="base-structure.html"><a href="base-structure.html#top-level-components-workflow-call-and-task"><i class="fa fa-check"></i><b>3.1</b> Top-level components: workflow, call and task</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="base-structure.html"><a href="base-structure.html#call"><i class="fa fa-check"></i><b>3.1.1</b> call</a></li>
<li class="chapter" data-level="3.1.2" data-path="base-structure.html"><a href="base-structure.html#task"><i class="fa fa-check"></i><b>3.1.2</b> task</a></li>
<li class="chapter" data-level="3.1.3" data-path="base-structure.html"><a href="base-structure.html#workflow"><i class="fa fa-check"></i><b>3.1.3</b> workflow</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="base-structure.html"><a href="base-structure.html#core-task-level-components-command-and-output"><i class="fa fa-check"></i><b>3.2</b> Core task-level components: command and output</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="base-structure.html"><a href="base-structure.html#command"><i class="fa fa-check"></i><b>3.2.1</b> command</a></li>
<li class="chapter" data-level="3.2.2" data-path="base-structure.html"><a href="base-structure.html#output"><i class="fa fa-check"></i><b>3.2.2</b> output</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="base-structure.html"><a href="base-structure.html#workflow-structure"><i class="fa fa-check"></i><b>3.3</b> Workflow Structure</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="workflow-1.html"><a href="workflow-1.html"><i class="fa fa-check"></i><b>4</b> Workflow</a>
<ul>
<li class="chapter" data-level="4.1" data-path="workflow-1.html"><a href="workflow-1.html#example-4"><i class="fa fa-check"></i><b>4.1</b> Example:</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="workflow-1.html"><a href="workflow-1.html#inputs"><i class="fa fa-check"></i><b>4.1.1</b> Inputs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="specify-inputs.html"><a href="specify-inputs.html"><i class="fa fa-check"></i><b>5</b> Specify inputs</a>
<ul>
<li class="chapter" data-level="5.1" data-path="specify-inputs.html"><a href="specify-inputs.html#generating-the-template-json"><i class="fa fa-check"></i><b>5.1</b> Generating the template JSON</a></li>
<li class="chapter" data-level="5.2" data-path="specify-inputs.html"><a href="specify-inputs.html#customizing-the-inputs-file-for-a-particular-run"><i class="fa fa-check"></i><b>5.2</b> Customizing the inputs file for a particular run</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="specify-inputs.html"><a href="specify-inputs.html#example-5"><i class="fa fa-check"></i><b>5.2.1</b> Example</a></li>
<li class="chapter" data-level="5.2.2" data-path="specify-inputs.html"><a href="specify-inputs.html#calls"><i class="fa fa-check"></i><b>5.2.2</b> Calls</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="call-1.html"><a href="call-1.html"><i class="fa fa-check"></i><b>6</b> Call</a>
<ul>
<li class="chapter" data-level="6.1" data-path="call-1.html"><a href="call-1.html#examples-1"><i class="fa fa-check"></i><b>6.1</b> Examples:</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="call-1.html"><a href="call-1.html#outputs"><i class="fa fa-check"></i><b>6.1.1</b> Outputs</a></li>
<li class="chapter" data-level="6.1.2" data-path="call-1.html"><a href="call-1.html#tasks"><i class="fa fa-check"></i><b>6.1.2</b> Tasks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="task-1.html"><a href="task-1.html"><i class="fa fa-check"></i><b>7</b> Task</a>
<ul>
<li class="chapter" data-level="7.1" data-path="task-1.html"><a href="task-1.html#example-6"><i class="fa fa-check"></i><b>7.1</b> Example:</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="task-aliasing.html"><a href="task-aliasing.html"><i class="fa fa-check"></i><b>8</b> Task aliasing</a>
<ul>
<li class="chapter" data-level="8.1" data-path="task-aliasing.html"><a href="task-aliasing.html#generic-example-script"><i class="fa fa-check"></i><b>8.1</b> Generic example script</a></li>
<li class="chapter" data-level="8.2" data-path="task-aliasing.html"><a href="task-aliasing.html#concrete-example"><i class="fa fa-check"></i><b>8.2</b> Concrete example</a></li>
<li class="chapter" data-level="8.3" data-path="task-aliasing.html"><a href="task-aliasing.html#concrete-example-script"><i class="fa fa-check"></i><b>8.3</b> Concrete example script</a></li>
<li class="chapter" data-level="8.4" data-path="task-aliasing.html"><a href="task-aliasing.html#wiring-tasks-together"><i class="fa fa-check"></i><b>8.4</b> Wiring Tasks Together</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="add-variables.html"><a href="add-variables.html"><i class="fa fa-check"></i><b>9</b> Add variables</a>
<ul>
<li class="chapter" data-level="9.1" data-path="add-variables.html"><a href="add-variables.html#adding-task-level-variables"><i class="fa fa-check"></i><b>9.1</b> Adding task-level variables</a></li>
<li class="chapter" data-level="9.2" data-path="add-variables.html"><a href="add-variables.html#adding-workflow-level-variables"><i class="fa fa-check"></i><b>9.2</b> Adding workflow-level variables</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="add-plumbing.html"><a href="add-plumbing.html"><i class="fa fa-check"></i><b>10</b> Add plumbing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="add-plumbing.html"><a href="add-plumbing.html#what-is-plumbing"><i class="fa fa-check"></i><b>10.1</b> What is plumbing?</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="add-plumbing.html"><a href="add-plumbing.html#simple-connections"><i class="fa fa-check"></i><b>10.1.1</b> Simple connections</a></li>
<li class="chapter" data-level="10.1.2" data-path="add-plumbing.html"><a href="add-plumbing.html#switching-and-iterating-logic"><i class="fa fa-check"></i><b>10.1.2</b> Switching and iterating logic</a></li>
<li class="chapter" data-level="10.1.3" data-path="add-plumbing.html"><a href="add-plumbing.html#efficiency-through-code-re-use"><i class="fa fa-check"></i><b>10.1.3</b> Efficiency through code re-use</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="add-plumbing.html"><a href="add-plumbing.html#plumbing-options"><i class="fa fa-check"></i><b>10.2</b> Plumbing options</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="add-plumbing.html"><a href="add-plumbing.html#linear-chaining"><i class="fa fa-check"></i><b>10.2.1</b> Linear Chaining</a></li>
<li class="chapter" data-level="10.2.2" data-path="add-plumbing.html"><a href="add-plumbing.html#multi-input-multi-output"><i class="fa fa-check"></i><b>10.2.2</b> Multi-input / Multi-output</a></li>
<li class="chapter" data-level="10.2.3" data-path="add-plumbing.html"><a href="add-plumbing.html#branch-and-merge"><i class="fa fa-check"></i><b>10.2.3</b> Branch and Merge</a></li>
<li class="chapter" data-level="10.2.4" data-path="add-plumbing.html"><a href="add-plumbing.html#conditionals-ifelse"><i class="fa fa-check"></i><b>10.2.4</b> Conditionals (if/else)</a></li>
<li class="chapter" data-level="10.2.5" data-path="add-plumbing.html"><a href="add-plumbing.html#scatter-gather-parallelism"><i class="fa fa-check"></i><b>10.2.5</b> Scatter-Gather Parallelism</a></li>
<li class="chapter" data-level="10.2.6" data-path="add-plumbing.html"><a href="add-plumbing.html#task-aliasing-1"><i class="fa fa-check"></i><b>10.2.6</b> Task Aliasing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-chaining-1.html"><a href="linear-chaining-1.html"><i class="fa fa-check"></i><b>11</b> Linear chaining</a>
<ul>
<li class="chapter" data-level="11.1" data-path="linear-chaining-1.html"><a href="linear-chaining-1.html#generic-example-script-1"><i class="fa fa-check"></i><b>11.1</b> Generic example script</a></li>
<li class="chapter" data-level="11.2" data-path="linear-chaining-1.html"><a href="linear-chaining-1.html#concrete-example-1"><i class="fa fa-check"></i><b>11.2</b> Concrete example</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="linear-chaining-1.html"><a href="linear-chaining-1.html#concrete-example-script-1"><i class="fa fa-check"></i><b>11.2.1</b> Concrete example script</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="scatter-gather-parallelism-1.html"><a href="scatter-gather-parallelism-1.html"><i class="fa fa-check"></i><b>12</b> Scatter-gather parallelism</a>
<ul>
<li class="chapter" data-level="12.1" data-path="scatter-gather-parallelism-1.html"><a href="scatter-gather-parallelism-1.html#generic-example-script-2"><i class="fa fa-check"></i><b>12.1</b> Generic example script</a></li>
<li class="chapter" data-level="12.2" data-path="scatter-gather-parallelism-1.html"><a href="scatter-gather-parallelism-1.html#concrete-example-2"><i class="fa fa-check"></i><b>12.2</b> Concrete example</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="scatter-gather-parallelism-1.html"><a href="scatter-gather-parallelism-1.html#concrete-example-script-2"><i class="fa fa-check"></i><b>12.2.1</b> Concrete example script</a></li>
<li class="chapter" data-level="12.2.2" data-path="scatter-gather-parallelism-1.html"><a href="scatter-gather-parallelism-1.html#managing-software-environments"><i class="fa fa-check"></i><b>12.2.2</b> Managing Software Environments</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="scatter-gather-parallelism-1.html"><a href="scatter-gather-parallelism-1.html#tools-for-editing-wdls"><i class="fa fa-check"></i><b>12.3</b> Tools for Editing WDLs</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="developing-testing-and-scaling-workflows.html"><a href="developing-testing-and-scaling-workflows.html"><i class="fa fa-check"></i><b>13</b> Developing, Testing and Scaling Workflows</a>
<ul>
<li class="chapter" data-level="13.1" data-path="developing-testing-and-scaling-workflows.html"><a href="developing-testing-and-scaling-workflows.html#developing-a-new-workflow"><i class="fa fa-check"></i><b>13.1</b> Developing a New Workflow</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="developing-testing-and-scaling-workflows.html"><a href="developing-testing-and-scaling-workflows.html#start-from-a-template"><i class="fa fa-check"></i><b>13.1.1</b> Start from a template</a></li>
<li class="chapter" data-level="13.1.2" data-path="developing-testing-and-scaling-workflows.html"><a href="developing-testing-and-scaling-workflows.html#chose-software-modules"><i class="fa fa-check"></i><b>13.1.2</b> Chose Software Modules</a></li>
<li class="chapter" data-level="13.1.3" data-path="developing-testing-and-scaling-workflows.html"><a href="developing-testing-and-scaling-workflows.html#add-tasks"><i class="fa fa-check"></i><b>13.1.3</b> Add Tasks</a></li>
<li class="chapter" data-level="13.1.4" data-path="developing-testing-and-scaling-workflows.html"><a href="developing-testing-and-scaling-workflows.html#scale-up-inputs"><i class="fa fa-check"></i><b>13.1.4</b> Scale Up Inputs</a></li>
<li class="chapter" data-level="13.1.5" data-path="developing-testing-and-scaling-workflows.html"><a href="developing-testing-and-scaling-workflows.html#prep-for-other-platforms-and-sharing"><i class="fa fa-check"></i><b>13.1.5</b> Prep for Other Platforms and Sharing</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="developing-testing-and-scaling-workflows.html"><a href="developing-testing-and-scaling-workflows.html#approaches-for-testing"><i class="fa fa-check"></i><b>13.2</b> Approaches for Testing</a></li>
<li class="chapter" data-level="13.3" data-path="developing-testing-and-scaling-workflows.html"><a href="developing-testing-and-scaling-workflows.html#scaling-up-moving-to-the-cloud"><i class="fa fa-check"></i><b>13.3</b> Scaling Up, Moving to the Cloud</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="chapter" data-level="14" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>14</b> References</a></li>
<li class="divider"></li>
<p style="text-align:center;"> <a href="https://github.com/jhudsl/OTTR_Template" target="blank" > This content was published with</a> <a href="https://bookdown.org/" target="blank"> bookdown by: </a> </p>
<p style="text-align:center;"> <a href="http://hutchdatascience.org/"> The Fred Hutch Data Science Lab </a></p>
<p style="text-align:center; font-size: 12px;"> <a href="https://github.com/rstudio4edu/rstudio4edu-book/"> Style adapted from: rstudio4edu-book </a> <a href ="https://creativecommons.org/licenses/by/2.0/"> (CC-BY 2.0) </a></p>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">WDL102: Designing Workflows</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <!--script src="https://kit.fontawesome.com/6a26f47516.js"></script-->
  <!--<script src="assets/hideOutput.js"></script>-->
  <link href="assets/style.css" rel="stylesheet">
</head>
        


<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/dasl_thin_main_image.png">
</div>
<div id="add-plumbing" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Add plumbing</h1>
<p>In this section, you’ll learn about the different plumbing options supported by WDL and how you can implement plumbing in your own workflows.</p>
<div id="what-is-plumbing" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> What is plumbing?</h2>
<p>By plumbing, we mean chaining tasks together to form sophisticated pipelines. So how do we do that in WDL?</p>
<p>With effortless grace, that’s how.</p>
<div id="simple-connections" class="section level3" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Simple connections</h3>
<p>At this point, you know how to include multiple tasks in your workflow script. If you were paying attention to the section about variables, you even know how to connect the output of one task to the input of the next. That enables you to build <strong>linear</strong> or simple <strong>branching and merging</strong> workflows of any length, with single or <strong>multiple inputs and outputs</strong> connected between tasks without any other code than what we’ve already covered.</p>
</div>
<div id="switching-and-iterating-logic" class="section level3" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> Switching and iterating logic</h3>
<p>In addition to those basic connection capabilities, you’ll sometimes need to be able to switch between alternate pathways and iterate over sets of data, either in series or in parallel. For that, we’re going to need some more code, but don’t worry… you don’t have to write any of it! Instead, we’re going to take advantage of some handy features built into WDL syntax that make it easy to add this logic without a lot of effort.</p>
<p>One of the features of this type in WDL is <strong>scatter-gather</strong> parallelism, which is a great way to speed up execution when you need to apply the same command to subsets of data that can be treated as independent units.</p>
<p>You can also use <strong>conditionals</strong> in WDL, which allow you to choose under which conditions you want a block of code to be executed.</p>
</div>
<div id="efficiency-through-code-re-use" class="section level3" number="10.1.3">
<h3><span class="header-section-number">10.1.3</span> Efficiency through code re-use</h3>
<p>Finally, you’ll find you often need to do similar things in different contexts. Rather than copying the relevant code into several places – which produces more code overall to maintain and update – you can re-use the code smartly, either through <a href="task_aliasing.md">task aliasing</a> if your problem involves running the same tool in different ways, or by importing workflows wholesale.</p>
<p>With all these options for assembling calls to tasks into workflows, we can build some fairly sophisticated data processing and analysis pipelines. Admittedly this can seem a bit overwhelming at first, but don’t worry – we’re here to help! Once you’re done going through the WDL basics, we’ll point you to a series of tutorials that show how to apply each option to some classic use cases that we encounter in genomics. But first, we’ll show you how to check that the syntax of a workflow is valid.</p>
<p>You can read about different plumbing options below, or continue to the next section, <a href="validate_syntax.md">Validate Syntax</a>.</p>
</div>
</div>
<div id="plumbing-options" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Plumbing options</h2>
<p>WDL supports several different plumbing options and you can read more about them below.</p>
<div id="linear-chaining" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Linear Chaining</h3>
<p>The simplest way to chain tasks together in a workflow is a <strong>linear chain</strong>, where we feed the output of one task to the input of the next, like so:</p>
<div class="figure">
<img src="../Images/linear-chaining.png" alt="" />
<p class="caption">Diagram depicting the flow of data in a workflow that uses linear chaining. The output from step A is used as the input for step B, and the output from step B is used as the input for step C.</p>
</div>
<p>This is easy to do because WDL allows us to refer to the output of any task (declared appropriately in the task’s <code>output</code> block) within the <code>call</code> statement of another task (and indeed, anywhere else in the <code>workflow</code> block), using the syntax <code>task_name.output_variable</code>. So here, we simply specify in the call to <code>stepB</code> that we want it to use <code>stepA.out</code> as the value of the input variable <code>in</code>, and it’s the same rule for <code>stepC</code>.</p>
<pre><code>call stepB {
  input:
    in = stepA.out
}
call stepC {
  input:
    in = stepB.out
}</code></pre>
<p>This relies on a principle called <em>hierarchical naming</em> that allows us to identify components by their parentage.</p>
</div>
<div id="multi-input-multi-output" class="section level3" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Multi-input / Multi-output</h3>
<p>The ability to connect outputs to inputs described in <a href="Linear_chaining.md">Linear Chaining</a>, which relies on <em>hierarchical naming</em>, allows you to chain together tools that produce multiple outputs and accept multiple inputs, and specify exactly which output feeds into which input.</p>
<div class="figure">
<img src="../Images/multi-input-multi-output.png" alt="" />
<p class="caption">Diagram depicting the flow of data in a workflow with tasks producing multiple outputs that are used as inputs to a downstream task. The output from step A is used as the input for step B, and the outputs from step B, out1 and out2, are used as the inputs for step C, in1 and in2.</p>
</div>
<p>Since the outputs for <code>stepB</code> are named differently, we can specify which output maps to which input for <code>stepC</code>.</p>
<pre><code>call stepC {
  input:
    in1 = stepB.out1,
    in2 = stepB.out2
}</code></pre>
</div>
<div id="branch-and-merge" class="section level3" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Branch and Merge</h3>
<p>The ability to connect outputs to inputs described in <a href="Linear_chaining.md">Linear Chaining</a> and <a href="MultiInput_MultiOutput.md">Multi-input/Multi-output</a>, which relies on <em>hierarchical naming</em>, can be further extended to direct a task’s outputs to separate paths, do something with them, then merge the branching paths back together.</p>
<div class="figure">
<img src="../Images/branch-and-merge.png" alt="" />
<p class="caption">Diagram depicting the flow of data in a workflow with branching paths that merge back together. The output from step A is used as the input for steps B and C, and the outputs from steps B and C are used as the inputs for step D.</p>
</div>
<p>Here you can see that the output of <code>stepA</code> feeds into both <code>stepB</code> and <code>stepC</code> to produce different outputs, which we then feed together into <code>stepD</code>.</p>
<pre><code>call stepB {
  input:
    in = stepA.out
}
call stepC {
  input:
    in = stepA.out
}
call stepD {
  input:
    in1 = stepC.out,
    in2 = stepB.out
}</code></pre>
</div>
<div id="conditionals-ifelse" class="section level3" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> Conditionals (if/else)</h3>
<p>Sometimes when pipelining, there are steps you won’t want to run all the time. This could mean switching between two paths (run a tool in modeA vs. run a tool in modeB) or skipping a step entirely (run a tool vs. not running a tool). In cases such as these, we will use a <strong>conditional</strong> statement.</p>
<div class="figure">
<img src="../Images/conditionals.png" alt="" />
<p class="caption">Diagram depicting the flow of data in a workflow with conditional statements. The output from step A is used to determine whether step B will be executed. If the conditional statement is true, the output from step A is used as the input for step B, and the output from step B is used as the input for step C. If the conditional statement is false, the output from step A is used as the input for step C, and step B is skipped.</p>
</div>
<p>To use a conditional statement in WDL, you write a standard <code>if</code> statement:</p>
<pre><code>if (shouldICallStepB) {
  call stepB {
    input:
      in = stepA.out
  }
}</code></pre>
<p>The <code>if</code> statement can be controlled explicitly, as we have done in the above example by using a Boolean variable. It can also be controlled implicitly by testing the value of some other variable with its own purpose besides being a switch mechanism.</p>
<pre><code>if (myVar&gt;0) {
  call stepB
}</code></pre>
<p>WDL doesn’t support <code>else</code> statements in this context, but we can get around that by writing paired <code>if</code> statements using the <code>!</code> modifier to get the opposite value of the original variable, like so:</p>
<pre><code>if (!shouldICallStepB) {
  call stepC {
    input:
      in = stepA.out
  }
}</code></pre>
</div>
<div id="scatter-gather-parallelism" class="section level3" number="10.2.5">
<h3><span class="header-section-number">10.2.5</span> Scatter-Gather Parallelism</h3>
<p>Parallelism is a way to make a program finish faster by performing several operations in parallel, rather than sequentially (i.e. waiting for each operation to finish before starting the next one). For a more detailed introduction on parallelism, you can read about it in-depth in the GATK article, <a href="https://gatk.broadinstitute.org/hc/en-us/articles/360035532012">Parallelism - Multithreading - Scatter Gather</a>.</p>
<div class="figure">
<img src="../Images/scatter-gather-parallelism.png" alt="" />
<p class="caption">Diagram depicting the flow of data in a workflow using scatter-gather parallelism. Several input files are fed into step A in parallel, and the output from each execution of step A is combined and used as the input for step B.</p>
</div>
<p>To do this, we use the <code>scatter</code> function from the <a href="https://github.com/openwdl/wdl/blob/main/versions/1.0/SPEC.md#standard-library">WDL standard library</a>, which will produce parallelizable jobs running the same task on each input in an array, and output the results as an array as well.</p>
<pre><code>input {
  Array[File] inputFiles
}
scatter (oneFile in inputFiles) {
  call stepA {
    input:
      in = oneFile
}
call stepB {
  input:
    files = stepA.out
}</code></pre>
<p>The magic here is that the array of outputs is produced and passed along to the next task without you ever making an explicit declaration about it being an array. Even though the output of <code>stepA</code> looks like a single file based on its declaration, just referring to <code>stepA.out</code> in any other <code>call</code> statement is sufficient for WDL to know that you mean the array grouping the outputs of all the parallelized <code>stepA</code> jobs.</p>
<p>In other words, the <strong>scatter</strong> part of the process is <em>explicit</em> while the <strong>gather</strong> part is <em>implicit</em>.</p>
</div>
<div id="task-aliasing-1" class="section level3" number="10.2.6">
<h3><span class="header-section-number">10.2.6</span> Task Aliasing</h3>
<p>When you need to call a task more than once in a workflow, you can use <strong>task aliasing</strong>. It would be tedious to copy-paste a task’s definition and change the name each time you needed to use it again in the workflow. This method, termed <a href="https://en.wikipedia.org/wiki/Copy-and-paste_programming">copy and paste programming</a>, is simple enough up front but difficult to maintain in the long run. Imagine you found a typo in one of your tasks–you’d need to fix that typo in every single pasted task! However, using WDL’s built-in task aliasing feature, you can call the same task code and assign it an alias. Then, following the principle of hierarchical naming, in order to access the output of an aliased task we use the alias, rather than the original task name.</p>
<div class="figure">
<img src="../Images/task-aliasing.png" alt="" />
<p class="caption">Diagram depicting the flow of data in a workflow using task aliasing. Step A is first called using the task alias, firstInput, and the output of this task is used as the input for step B. Step A is called a second time using the task alias, secondInput, and the output of this task is used as the input for step C.</p>
</div>
<p>To use an alias, we use the syntax <code>call taskName as aliasName</code>.</p>
<pre><code>call stepA as firstInput {
  input:
    in = in1
}
call stepA as secondInput {
  input:
    in = in2
}
call stepB {
  input:
    in = firstInput.out
}
call stepC {
  input:
    in = secondInput.out
}</code></pre>
<p>Continue to the next section, <a href="./validate_syntax.md">Validate Syntax</a>.</p>
</div>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All illustrations <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY. </a>
      <br>
      All other materials <a href= "https://creativecommons.org/licenses/by/4.0/"> CC-BY </a> unless noted otherwise.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="add-variables.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-chaining-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
